# Bot Forms
Инструмент решает задачу автоматической отправки форм на сайтах

## Установка
```sh
git clone https://github.com/rickert155/botForms.git
```
```sh
cd botForms
```
```sh
python3 -m venv venv
```
```sh
source venv/bin/activate
```
```sh
pip install -r package.txt
```

Создаем директорию Base для хранения в ней баз. Обазятельные поля в csv - Domain, Company  
В директории Data нужно добавить content.json с контентом. Можно скопировать template.json и его заполить по своему усмотрению  
После этого можем запустить рассылку по формам
```sh
python3 botForms.py
```

## Отладка
На время отладки можно использовать простой api
```sh
python3 -m modules.form domain.co
```

## Мониторинг
Для отслеживания состаяния рассыльщика можно использовать modules.monitor
```sh
python3 -m modules.monitor
```
вот пример реального вывода
```sh
Всего доменов:		7327
Пройдено доменов:	2968
Прогресс:		40.51 %

Форма с неизвестным полем - 46
Не найдено форм - 871
Редирект домена - 88
Долгая загрузка страниц - 486
Успешная отправка - 273

Успешная обработка:	1278
Процент отправленных:	21.36 %
Проверено сегодня:	936
```

## Обработка результатов
Актуально на случай, если есть много документов с результатами рассылки и нужно в короткий срок все обработать и подвести статистику.  
Для обработки баз необходимо создать директорию Analytics, в противном случае она будет создана автоматически. В нее нужно добавить документы, которые были получены в ходе отправки форм. Модуль можно использовать следующей командой:
```sh
python3 -m modules.analytics
```
Результат может быть таким:
```sh
Обнаружено документов: 30
NOT CONNECTED:	3344
NOT DEFINED:	3920
REDIRECT:	    881
UNKNOWN FIELD:	449
SUCCESS:	    2661
```
Слитые документы будут объединены по типу и будут находиться в директории AnalResult.

## Быстрый свод статистики
Для быстрого свода статистики можно использовать модуль modules.temp_processing. Пойдет на тот случай, когда есть результаты модуля monitor. Их можно записать в текстовый файл и провести подсчет
```sh
python3 -m modules.temp_processing base_name.txt
```

## Запуск сервиса
Инструмент можно повесить как демона systemd на сервер или виртульную машину. Для этого подготовлен botforms@.service.  
**ВНИМАНИЕ!** - в данном юните подразумевается, что инструмент находится в директории ~/Parser/BotForms. Если путь отличается - его необходимо поправить в юните.  
Копируем сервис
```sh
sudo cp botforms@.service /etc/systemd/system/
```
Обновляем базу сервисов
```sh
sudo systemctl daemon-reload
```
Запускаем(user заменить на вашего текущего юзера)
```sh
sudo systemctl start botforms@user
```
При необходимости можно добавить в автозагрузку
```sh
sudo systemctl enable botforms@user
```
